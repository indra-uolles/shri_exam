<html>

<head>
    <link rel="stylesheet" type="text/css" href="css/main.css">
</head>

<body>
    <div class="wrap">
        <div class="header box" id="header">

        </div>
        <div class="content" id="content">
        </div>
    </div>
    <script src="../node_modules/yate/lib/runtime.js"></script>
    <script src="./js/logo.js"></script>
    <script src="./js/horizontal_menu.js"></script>
    <script src="./js/jquery-1.10.2.min.js"></script>
    <script src="./js/students.js"></script>
    <script>
    //получаем логотип
    var data = {
        logo_name: 'Яндекс ШРИ в Москве 2013',
        when_where: '7 сентября - 31 декабря'
    };
    var cpl_logo = yr.run('logo', data);
    //получаем горизонтальное меню
    data = {
        item: [{
            link: '#',
            title: 'О мероприятии',
            id: 'page_index'
        }, {
            link: '#',
            title: 'Программа',
            id: 'page_lectures'
        }, {
            link: '#',
            title: 'Докладчики',
            id: 'page_lectors'
        }, {
            link: '#',
            title: 'Правила отбора',
            id: 'page_rules'
        }, {
            link: '#',
            title: 'FAQ',
            id: 'page_faq'
        }, {
            link: '#',
            title: 'Выпускники',
            id: 'page_students'
        }]
    }
    var cpl_menu = yr.run('horizontal_menu', data);

    //собираем главную страницу
    $("#header").html(cpl_logo + cpl_menu);
    $("#content").load("./pages/index.html");

    //обработка навигации по верхнему меню
    $('#page_index').on('click', function() {
        $("#content").load("./pages/index.html");
    });
    $('#page_lectures').on('click', function() {
        $("#content").html('');
        $("#content").append(get_lectures());
        $(".one-lecture").on('click', function(e) {
            //формируем вид лекции
            var x = new XMLHttpRequest();
            x.open("GET", "./json/lectures.json", false);
            x.send();
            var lectures = x.responseText;
            filtered_lectures = JSPath.apply('.lectures{.id === ' + this.id + '}', JSON.parse(lectures));
            $("#content").html('');
            $("#content").append(get_lecture(this.id));

            //подгружаем скрипт для кнопок "Показать..." "Скрыть..."
            $.getScript('./js/accordeon.js', function(){});

            //обработчик для ссылки "Программа (все лекции)"
            $('.go_page_lectures').on('click', function() {
                $("#page_lectures").trigger("click");
            });
            return false;
        });
    });
    $('#page_lectors').on('click', function() {
        var data = {
            item: [{
                link: '#',
                id: '1',
                class: 'lectors_filter',
                title: 'Все'
            }, {
                link: '#',
                id: '2',
                class: 'lectors_filter',
                title: 'Инструменты'
            }, {
                link: '#',
                id: '3',
                class: 'lectors_filter',
                title: 'Технологии'
            }, {
                link: '#',
                id: '4',
                class: 'lectors_filter',
                title: 'Языки'
            }, {
                link: '#',
                id: '5',
                class: 'lectors_filter',
                title: 'Дизайн'
            }, {
                link: '#',
                id: '6',
                class: 'lectors_filter',
                title: 'Фреймворки'
            }]
        }
        var cpl_content_filter = yr.run('lectors_filter', data);

        sel_number = 1;
        $("#content").html('');
        $("#content").append(cpl_content_filter);
        $("#content").append(get_lectors(1));

        $('.lectors_filter').on('click', function() {
            $("#people").html(get_lectors(Number(this.id)));
        });
    });

    $('#page_rules').on('click', function() {
        $("#content").load("./pages/rules.html");
    });
    $('#page_faq').on('click', function() {
        $("#content").load("./pages/faq.html");
    });
    $('#page_students').on('click', function() {
        $("#content").html(get_students());

        $('.people-sticker').on('click', function() {
            $("#content").html(get_student(this.id));
            $('.go_page_students').on('click', function() {
                $("#page_students").trigger("click");
            });
        });
    });
    </script>
    <div class="footer">
        © 2013 ООО «<a href="http://www.yandex.ru">Яндекс</a>»
    </div>
    <script src="./js/jspath.min.js"></script>
    <script src="./js/lectors.js"></script>
    <script src="./js/lectors_filter.js"></script>
    <script src="./js/text_media.js"></script>
    <script src="./js/multi_column_links.js"></script>
    <script src="./js/html_from_json.js"></script>
    <script src="./js/lecture.js"></script>
    <script src="./js/alumni.js"></script>
    <script src="./js/text.js"></script>
</body>

</html>